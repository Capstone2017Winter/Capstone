{% load static %}
<html>
	<head id="head">
		<div id="imageMe">
			<h1 style="color:#FFFF00;width:200px;height:200px">Hello World!</h1>
		</div>	
		<img id = "image" src="{% static 'schedule_builder/lena512.bmp' %}"> 
		<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
		<meta content="utf-8" http-equiv="encoding">
		<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" ></script>
		<script type="text/javascript" src="{% static 'schedule_builder/dom-to-image.js' %}"></script>
		<script type="text/javascript">
			$(document).ready(function(){

				var img = document.getElementById("imageMe");
				domtoimage.toBmp(img)
					.then(function (dataUrl) {

						dataUrl = dataUrl;

						var xhr = new XMLHttpRequest()
						xhr.open("GET", "http://192.168.1.101", true);
						xhr.send("IMAGE_REQUEST");

						if(xhr.status === 200){
							if(xhr.responseText() === "SEND_DATA"){
								xhr.open("POST", "http://192.168.1.101/IMAGE_DATA/", true);

								xhr.send(dataUrl);
							}
						}
						var newImg = '<img src="' + dataUrl + '"/>';
						$('body').append(newImg);
					});				
			});
		</script>
	</head>
	<body id="body">
	</body>
</html>
